{"version":3,"sources":["firebase.js","contexts/AuthContext.js","components/Chats.js","components/Login.js","components/App.js","index.js"],"names":["auth","firebase","initializeApp","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","RAECT_APP_FIREBASE_MEASURMENT_ID","AuthContext","React","createContext","AuthProvider","children","useState","loading","setLoading","user","setUser","history","useHistory","useEffect","onAuthStateChanged","push","value","Provider","PROJECT_ID","Chats","useContext","handleLogout","a","signOut","getFile","url","fetch","response","blob","data","File","type","console","log","axios","get","headers","email","uid","then","catch","error","formdata","FormData","append","photoURL","avatar","name","post","className","onClick","height","projectID","userName","userSecret","Login","id","signInWithRedirect","GoogleAuthProvider","GoogleOutlined","FacebookAuthProvider","FacebookOutlined","App","style","fontFamily","path","component","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.32ada1df.chunk.js","sourcesContent":["import firebase from 'firebase/app';\nimport \"firebase/auth\";\n\nexport const auth = firebase.initializeApp({\n    apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n    authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n    projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.REACT_APP_FIREBASE_APP_ID,\n    measurementId: process.env.RAECT_APP_FIREBASE_MEASURMENT_ID,\n  }).auth();","import React, { useContext, useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { auth } from '../firebase';\n\nconst AuthContext = React.createContext();\n\nexport const useAuth = () => useContext(AuthContext);\n\nexport const AuthProvider = ( {children }) => {\n    const [loading, setLoading] = useState(true);\n    const [user, setUser] = useState(null);\n    const history = useHistory();\n\n    useEffect( () => {\n        auth.onAuthStateChanged((user) => {\n            setUser(user);\n            setLoading(false);\n            \n            if(user) history.push('/chats');\n        });\n    }, [user, history]);\n\n    const value = { user };\n\n    return (\n        <AuthContext.Provider value={value}>\n            {!loading && children}\n        </AuthContext.Provider>\n    )\n}","import React, { useRef, useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { ChatEngine } from 'react-chat-engine';\nimport { auth } from '../firebase';\n\nimport { useAuth } from '../contexts/AuthContext';\nimport axios from 'axios';\n\nconst PROJECT_ID = process.env.REACT_APP_CHAT_ENGINE_PROJECT_ID;\nconst PRIVATE_KEY = process.env.REACT_APP_CHAT_ENGINE_PRIVATE_KEY;\n\nconst Chats = () => {\n    const [loading, setLoading] = useState(true);\n    const history = useHistory();\n    const { user } = useAuth();\n\n    const handleLogout = async () => {\n        await auth.signOut();\n\n        history.push('/');\n    }\n\n    const getFile = async (url) => {\n        \n        const response = await fetch(url);\n        const data = await response.blob();\n\n        return new File([data], \"userPhoto.jpg\", { type: 'image/jpg' });\n    }\n\n    useEffect( () => {\n        if(!user) {\n            history.push('/');\n            return;\n        }\n        console.log('***', user)\n        axios.get(\n            'https://api.chatengine.io/users/me', \n            { headers: {\n                \"project-id\": PROJECT_ID,\n                \"user-name\": user.email,\n                \"user-secret\": user.uid\n            }\n        })\n        .then( () => {\n            setLoading(false);\n        })\n        .catch( (error) => {\n            try {\n                let formdata = new FormData();\n                formdata.append('email', user.email);\n                formdata.append('username', user.email);\n                formdata.append('secret', user.uid);\n                getFile(user.photoURL)\n                    .then( (avatar) => {\n                        formdata.append('avatar', avatar, avatar.name)\n                        axios.post('https://api.chatengine.io/users/', \n                            formdata,\n                            { headers: {\"private-key\": PRIVATE_KEY}}\n                        )\n                        .then( () => {setLoading(false)})\n                        .catch( (error) => { console.log(error) })\n                    })   \n            } catch (error) {\n                console.log('account creation login error: ' + error);\n                handleLogout();\n            }\n        })\n    }, []);\n\n    if (!user || loading) return 'Loading..'\n\n    return (\n        <div className=\"chat-page\">\n            <div className=\"nav-bar\">\n                <div className=\"logo-tab\">\n                    UndMe\n                </div>\n                <div onClick={handleLogout} className=\"logout-tab\">\n                    Logout\n                </div>\n            </div>\n            \n            <ChatEngine\n                height=\"calc(100vh - 66px)\"\n                projectID={PROJECT_ID}\n                userName={user.email}\n                userSecret={user.uid}\n            />\n        </div>\n    )\n}\n\nexport default Chats;","import React from 'react';\nimport { GoogleOutlined, FacebookOutlined } from '@ant-design/icons';\nimport \"firebase/app\";\n\nimport { auth } from '../firebase';\nimport firebase from 'firebase/app';\n\nconst Login = () => {\n    return (\n        <div id=\"login-page\">\n            <div id=\"login-card\">\n                <h2>Welcome to UndMe</h2>\n\n                <div\n                    className=\"login-button google\"\n                    onClick={() => auth.signInWithRedirect(new firebase.auth.GoogleAuthProvider())}\n                >\n                    <GoogleOutlined /> Sign in with Google\n                </div>\n\n                <br /> <br />\n\n                <div\n                    className=\"login-button facebook\"\n                    onClick={() => auth.signInWithRedirect(new firebase.auth.FacebookAuthProvider())}\n                >\n                    <FacebookOutlined /> Sign in with Google\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default Login;","import React from \"react\"\n\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\"\n\nimport { AuthProvider } from \"../contexts/AuthContext\"\n\nimport Chats from \"./Chats\"\nimport Login from \"./Login\"\n\nfunction App() {\n  return (\n    <div style={{ fontFamily: 'Avenir' }}>\n      <Router>\n        <AuthProvider>\n          <Switch>\n            <Route path=\"/chats\" component={Chats} />\n            <Route path=\"/\" component={Login} />\n          </Switch>\n        </AuthProvider>\n      </Router>\n    </div>\n  )\n}\n\nexport default App\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}